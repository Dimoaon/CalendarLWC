<template>
    <div class="calendar">

        <!-- ================= HEADER ================= -->
        <c-calendar-header
            month-label={monthLabel}
            current-year={currentYear}
            search-results={searchResults}

            is-quick-add-open={isAddQuickMode}
            quick-add-title={newEventTitle}

            onprevmonth={handlePrevMonth}
            onnextmonth={handleNextMonth}
            onmonthchange={handleMonthChange}
            onyearchange={handleYearChange}

            onaddevent={handleAddEventClick}
            onquickclose={closePopup}
            onquickinput={handleTitleInput}
            onquicksave={handleQuickSave}

            onsearch={handleSearchInput}
            onsearchselect={handleSearchSelect}
        >
        </c-calendar-header>

        <!-- ================= GRID ================= -->
        <c-calendar-grid
            cells={cells}
            oncellclick={handleCellSelect}
        >
        </c-calendar-grid>

        <!-- ================= LIST MODE ================= -->
        <template if:true={isListMode}>
            <c-event-details-popup
                mode="list"
                events={eventsForSelectedDate}
                rect={activeCellRect}

                onselectevent={handleEventSelect}
                onaddevent={openAddFromList}
                onclose={closePopup}
            >
            </c-event-details-popup>
        </template>

        <!-- ================= DETAILS MODE ================= -->
        <template if:true={isDetailsMode}>
            <c-event-details-popup
                mode="details"
                event={selectedEvent}
                rect={activeCellRect}

                onclose={closePopup}
                ondeleteevent={handleDeleteEvent}
            >
            </c-event-details-popup>
        </template>

        <!-- ================= ADD FULL MODE ================= -->
        <template if:true={isAddFullMode}>
            <c-event-details-popup
                mode="addFull"
                rect={activeCellRect}

                ontitleinput={handleTitleInput}
                onparticipantsinput={handleParticipantsInput}
                ondescriptioninput={handleDescriptionInput}

                onsave={handleFullSave}
                onclose={closePopup}
            >
            </c-event-details-popup>
        </template>

    </div>
</template>
